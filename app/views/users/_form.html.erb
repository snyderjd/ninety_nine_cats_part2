<% action = user.persisted? ? user_url(user) : users_url %>
<% method = user.persisted? ? "patch" : "post" %>
<% message = user.persisted? ? "Update user" : "Create user" %>

<form action="<%= action %>" method="POST">

    <%# Hidden inputs for method action and authenticity_token %>
    <input name="_method" type="hidden" value="<%= method %>">
    <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>">

    <%# Add labels and inputs for username and password %>

    <input type="submit" value="<%= message %>">
</form>